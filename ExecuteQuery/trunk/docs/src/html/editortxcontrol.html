<html>
<head>
<title>Editor Transaction Control</title>
<link rel="stylesheet" type="text/css" href="eqhelp.css">
</head>
<body>
<table width="100%"  border="0" cellpadding="2" cellspacing="0">
  <tr>
    <td background="../images/header.gif">
      <OBJECT CLASSID="java:org.executequery.gui.help.HelpLinkLabel">
        <param name="iconByName" value="../images/header-text-1.gif">
        <param name="urlRedirect" value="http://executequery.org">
        <param name="mouseOverText" value="Visit executequery.org">
      </OBJECT></td>
    <td align="right" background="../images/header.gif">
      <OBJECT CLASSID="java:org.executequery.gui.help.HelpLinkLabel">
        <param name="iconByName" value="../images/header-text-2.gif">
        <param name="urlRedirect" value="http://executequery.org">
        <param name="mouseOverText" value="Visit executequery.org">
      </OBJECT></td>
  </tr>
</table>
<table width="100%"  border="0" cellpadding="2" cellspacing="0">
  <tr>
    <td><img src="../images/spacer.png" height="3"></td>
  </tr>
  <tr>
    <td><h1>Editor Transaction Control</h1><hr></td>
  </tr>
  <tr>
    <td><img src="../images/spacer.png" height="3"></td>
  </tr>
  <tr>
    <td><p>The Query Editor employs transaction control techniques as found in
        most (if not all) similar tools shipped as a part of any particular
        database product.</p>
        <p>Commit and rollback blocks are specific to the current editor's
        connection which remains with a single editor for the duration of its
        use - ie. opening multiple editors creates a separate connection for
        each.</p>
        <p>Editors support two commit modes - <a href="#manual">manual</a> or 
        <a href="#auto">auto</a> - and this may be
        toggled by selecting the Toggle auto-commit on/off button from the
        editor's toolbar.</p>
    </td>
  </tr>
  <tr>
    <td><a name="manual"></a><h2>Manual-Commit Mode</h2></td>
  </tr>
  <tr>
    <td><p>In manual commit mode, each statement sent to the database is not
        committed or rolled back until the user explicitly does so using either 
        the Commit/Rollback button from the editor's toolbar or sending a single
        'commit' or 'rollback' statement to the database as shown below.</p><br>
        <div class="examplecode">
          <pre>
1.  INSERT INTO people (first_name, second_name) 
2.  VALUES ('John', 'Smith');
3.
4.  UPDATE people SET first_name = 'Robert'
5.  WHERE people_id = 9652;
6.
7.  commit;
</pre>
        </div>
        <p>In the example above, the first two statements on lines 1 and 4 would
        not be committed until line 7. Alternatively, in the absence of the 
        'commit' at line 7, selection of the Commit button will complete the 
        transaction.</p>
        <p>Rollback statements work in the same manner.</p>
        <p>Depending on the driver and database in use, were the first statement
        at line 1 to return an error, subsequent statements such as the
        second at line 4 would also return an error where it otherwise would 
        not. In such cases, the transaction needs to be reset (commit or
        rollback) before execution may continue.</p>
        <p><i>Note:</i> Some database drivers and products do not accept
        creation of certain objects such as tables whilst in manual transaction
        mode. In such cases, toggle the transaction mode to auto-commit.</p>
    </td>
  </tr>
  <tr>
    <td><a name="auto"></a><h2>Auto-Commit Mode</h2></td>
  </tr>
  <tr>
    <td><p>In auto commit mode, each statement is committed as it is executed
        depending on the driver and database implementation.</p>
        <p>Reusing the example above:</p><br>
        <div class="examplecode">
          <pre>
1.  INSERT INTO people (first_name, second_name) 
2.  VALUES ('John', 'Smith');
3.
4.  UPDATE people SET first_name = 'Robert'
5.  WHERE people_id = 9652;
</pre>
        </div>
        <p>Both of the above statements would be committed to the database
        following successful execution of each individual query.</p>
        <p>Where it was previously noted that when in manual transaction mode an
        earlier statement can affect the success of any statement after it, this
        does not apply to auto-commit. If the first statement at line 1 fails,
        the second is executed in turn and may succeed or fail irrespective of
        any previously executed queries.</p>
    </td>
  </tr>
</table>
</body>
</html>
